---
title: "Coding - Exercise"
author: "Sushma Tiwari"
date: "2024-10-10"
output: html_document
---

## Coding Exercises
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
source("setup.R")
```

```{r}
data("knz_bison")
```

1.  Create a new column in the bison dataset that calculates the individual's age at the time of observation.

```{r}
knz_bison <- knz_bison %>%
  mutate(age_at_observation = rec_year - animal_yob)

head(knz_bison)
```
2.  Write a function that will first filter the bison dataset based on any user-specified weight threshold (returning the filtered dataset).
```{r}
bison_weight <- function(data, weight_threshold) {
  filtered_data <- data %>%
    filter(animal_weight >= weight_threshold)
  return(filtered_data)
}

filtered_bison <- bison_weight(knz_bison, 700)
head(filtered_bison)
```
3.  Create a boxplot showing weight distribution between male and female bison, and then conduct a t-test to see if weight is significantly difference between males and females.
```{r}
ggplot(knz_bison, aes(x = animal_sex, y = animal_weight, fill = animal_sex)) +
  geom_boxplot() +
  labs(title = "Weight Distribution of Bison by Sex",
       x = "Sex",
       y = "Weight") +
  theme_minimal()
```

```{r}
levene_result <- knz_bison %>% 
  levene_test(animal_weight ~ animal_sex)
print(levene_result)
```

```{r}
welch_t_test_result <- knz_bison %>% 
  t_test(animal_weight ~ animal_sex, var.equal = FALSE, detailed = TRUE)

print(welch_t_test_result)
```


